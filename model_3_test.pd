#N canvas 0 66 3440 1340 16;
#X obj 846 1225 nn.bp_2x2;
#X obj 78 54 f \$0;
#X obj 78 82 s \$0_ns;
#X msg 78 26 bang;
#X obj 26 28 bng 40 250 50 0 \$0_init empty init 0 -12 0 16 #fcfcfc #000000 #000000;
#N canvas 0 50 450 250 (subpatch) 0;
#X array \$0_X 4 float 3;
#A 0 -0.371437 -0.114304 0.142874 0.742864;
#X coords 0 1 4 -1 200 140 1;
#X restore 53 492 graph;
#N canvas 0 50 450 250 (subpatch) 0;
#X array \$0_Y 4 float 3;
#A 0 0.271418 -0.685685 0.771395 0.185686;
#X coords 0 1 4 -1 200 140 1;
#X restore 53 664 graph;
#N canvas 0 50 450 250 (subpatch) 0;
#X array \$0_y_hat 4 float 3;
#A 0 0.153436 0.140205 0.130932 0.120037;
#X coords 0 1 4 -1 200 140 1;
#X restore 53 831 graph;
#N canvas 1404 401 1456 921 arrays 0;
#X obj 621 146 array define -k \$0_zL 4;
#A 0 0.153436 0.140205 0.130932 0.120037;
#X text 617 119 // aL is \$0_y_hat;
#X obj 641 176 array define -k \$0_wL 2;
#A 0 0.434795 0.19797;
#X obj 641 205 array define -k \$0_bL 1;
#A 0 0.312915;
#X obj 1181 117 array define -k \$0_daL 4;
#A 0 -0.117927 0.82589 -0.640463 -0.0656494;
#X obj 1181 146 array define -k \$0_dzL 4;
#A 0 -0.117927 0.82589 -0.640463 -0.0656494;
#X obj 1181 176 array define -k \$0_dwL 2;
#A 0 0.00308942 0.0076337;
#X obj 1181 205 array define -k \$0_dbL 1;
#A 0 0.000462662;
#X obj 621 257 array define -k \$0_aL-1_0 4;
#A 0 -0.366792 -0.397046 -0.418359 -0.443399;
#X obj 621 286 array define -k \$0_zL-1_0 4;
#A 0 -0.384712 -0.420137 -0.445701 -0.476454;
#X obj 641 316 array define -k \$0_wL-1_0 3;
#A 0 0.286012 0.19787 0.24213;
#X obj 641 345 array define -k \$0_bL-1_0 1;
#A 0 -0.0825257;
#X obj 1181 257 array define -k \$0_daL-1_0 4;
#A 0 -0.0513104 0.359348 -0.278668 -0.0285643;
#X obj 1181 286 array define -k \$0_dzL-1_0 4;
#A 0 -0.0444179 0.302699 -0.229895 -0.0229485;
#X obj 1181 316 array define -k \$0_dwL-1_0 3;
#A 0 -0.000919123 -0.000223771 0.00513489;
#X obj 1181 345 array define -k \$0_dbL-1_0 1;
#A 0 0.00135943;
#X obj 621 387 array define -k \$0_aL-1_1 4;
#A 0 0.273434 0.208172 0.160073 0.100677;
#X obj 621 416 array define -k \$0_zL-1_1 4;
#A 0 0.280572 0.211259 0.161461 0.101019;
#X obj 641 446 array define -k \$0_wL-1_1 3;
#A 0 0.010473 -0.31042 0.46852;
#X obj 641 475 array define -k \$0_bL-1_1 1;
#A 0 0.400719;
#X obj 1181 387 array define -k \$0_daL-1_1 4;
#A 0 -0.0233459 0.163501 -0.126793 -0.0129966;
#X obj 1181 416 array define -k \$0_dzL-1_1 4;
#A 0 -0.0215986 0.156416 -0.123544 -0.0128649;
#X obj 1181 446 array define -k \$0_dwL-1_1 3;
#A 0 -0.000147805 0.000363626 0.00364401;
#X obj 1181 475 array define -k \$0_dbL-1_1 1;
#A 0 -0.000397788;
#X obj 621 527 array define -k \$0_aL-2_0 4;
#A 0 -0.321126 -0.313485 -0.305978 -0.288315;
#X obj 621 556 array define -k \$0_zL-2_0 4;
#A 0 -0.332902 -0.324406 -0.316101 -0.296728;
#X obj 641 586 array define -k \$0_wL-2_0 3;
#A 0 0.1127 0.18524 -0.2652;
#X obj 641 615 array define -k \$0_bL-2_0 1;
#A 0 -0.320741;
#X obj 1181 527 array define -k \$0_daL-2_0 4;
#A 0 -0.0129258 0.0881834 -0.0670235 -0.00669597;
#X obj 1181 556 array define -k \$0_dzL-2_0 4;
#A 0 -0.0115943 0.0795174 -0.0607486 -0.00613936;
#X obj 1181 586 array define -k \$0_dwL-2_0 3;
#A 0 -0.00450568 -0.00450568 -0.00450568;
#X obj 1181 615 array define -k \$0_dbL-2_0 1;
#A 0 0.000258768;
#X obj 621 657 array define -k \$0_aL-2_1 4;
#A 0 -0.418613 -0.424003 -0.429403 -0.441881;
#X obj 1181 657 array define -k \$0_daL-2_1 4;
#A 0 -0.00208432 0.0113404 -0.00713884 -0.000547305;
#X obj 621 686 array define -k \$0_zL-2_1 4;
#A 0 -0.446009 -0.452562 -0.459164 -0.474566;
#X obj 1181 686 array define -k \$0_dzL-2_1 4;
#A 0 -0.00171914 0.0093016 -0.00582254 -0.000440439;
#X obj 641 716 array define -k \$0_wL-2_1 3;
#A 0 0.439249 -0.30363 -0.16125;
#X obj 1181 716 array define -k \$0_dwL-2_1 3;
#A 0 -0.000395934 -0.000395934 -0.000395934;
#X obj 641 745 array define -k \$0_bL-2_1 1;
#A 0 -0.455529;
#X obj 1181 745 array define -k \$0_dbL-2_1 1;
#A 0 0.000329873;
#X obj 621 787 array define -k \$0_aL-2_2 4;
#A 0 -0.526616 -0.678222 -0.788255 -0.925924;
#X obj 621 816 array define -k \$0_zL-2_2 4;
#A 0 -0.585451 -0.825815 -1.06681 -1.62904;
#X obj 641 846 array define -k \$0_wL-2_2 3;
#A 0 -0.276104 -0.30151 -0.35918;
#X obj 641 875 array define -k \$0_bL-2_2 1;
#A 0 -0.933411;
#X obj 1181 787 array define -k \$0_daL-2_2 4;
#A 0 -0.0208743 0.146577 -0.113547 -0.011584;
#X obj 1182 816 array define -k \$0_dzL-2_2 4;
#A 0 -0.0150947 0.0791534 -0.042995 -0.00165262;
#X obj 1181 846 array define -k \$0_dwL-2_2 3;
#A 0 -0.00270285 -0.00270285 -0.00270285;
#X obj 1181 875 array define -k \$0_dbL-2_2 1;
#A 0 0.00485279;
#X msg 360 468 const 0;
#X msg 943 458 const 0;
#X obj 53 16 inlet;
#X obj 53 44 t b b, f 113;
#X text 237 568 // tmp fix;
#X obj 32 569 array define -k \$0_dX_0 4;
#A 0 0.00211525 -0.00886482 0.00250639 -0.000425845;
#X obj 32 609 array define -k \$0_dX_1 4;
#A 0 0.00292544 -0.01196 0.00347826 -0.000505243;
#X obj 31 649 array define -k \$0_dX_2 4;
#A 0 0.00877373 -0.0510182 0.0324924 0.00229277;
#X connect 48 0 0 0;
#X connect 48 0 41 0;
#X connect 48 0 40 0;
#X connect 48 0 34 0;
#X connect 48 0 32 0;
#X connect 48 0 25 0;
#X connect 48 0 24 0;
#X connect 48 0 17 0;
#X connect 48 0 16 0;
#X connect 48 0 9 0;
#X connect 48 0 8 0;
#X connect 49 0 47 0;
#X connect 49 0 46 0;
#X connect 49 0 45 0;
#X connect 49 0 44 0;
#X connect 49 0 39 0;
#X connect 49 0 37 0;
#X connect 49 0 35 0;
#X connect 49 0 33 0;
#X connect 49 0 31 0;
#X connect 49 0 30 0;
#X connect 49 0 29 0;
#X connect 49 0 28 0;
#X connect 49 0 23 0;
#X connect 49 0 22 0;
#X connect 49 0 21 0;
#X connect 49 0 20 0;
#X connect 49 0 15 0;
#X connect 49 0 14 0;
#X connect 49 0 13 0;
#X connect 49 0 12 0;
#X connect 49 0 7 0;
#X connect 49 0 6 0;
#X connect 49 0 5 0;
#X connect 49 0 4 0;
#X connect 50 0 51 0;
#X connect 51 0 48 0;
#X connect 51 1 49 0;
#X restore 24 204 pd arrays;
#X msg 24 176 bang;
#N canvas 1113 348 675 664 iterator 0;
#X obj 44 31 inlet toggle;
#X obj 44 157 f;
#X obj 44 215 t f f;
#X obj 291 31 inlet batch_size;
#X obj 98 215 + 1;
#X obj 44 263 mod;
#X obj 44 291 t f f;
#X obj 81 324 sel;
#X msg 287 290 0;
#X obj 81 352 t b b, f 16;
#X obj 81 380 s \$0_m_0;
#X obj 44 437 s \$0_m_i;
#X obj 44 87 t b b;
#X obj 81 115 s \$0_m_b;
#X obj 291 59 t f f;
#X obj 328 105 - 1;
#X obj 44 59 metro 25, f 17;
#X obj 177 31 inlet rate;
#X connect 0 0 16 0;
#X connect 1 0 2 0;
#X connect 2 0 5 0;
#X connect 2 1 4 0;
#X connect 3 0 14 0;
#X connect 4 0 1 1;
#X connect 5 0 6 0;
#X connect 6 0 11 0;
#X connect 6 1 7 0;
#X connect 7 0 9 0;
#X connect 8 0 1 1;
#X connect 9 0 10 0;
#X connect 9 1 8 0;
#X connect 12 0 1 0;
#X connect 12 1 13 0;
#X connect 14 0 5 1;
#X connect 14 1 15 0;
#X connect 15 0 7 1;
#X connect 16 0 12 0;
#X connect 17 0 16 1;
#X restore 175 51 pd iterator;
#X f 23;
#X obj 175 24 tgl 23 0 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 0 1;
#X obj 265 25 nbx 5 21 -1e+37 1e+37 0 1 empty empty ms 0 -12 0 16 #fcfcfc #000000 #000000 25 256;
#X obj 356 25 nbx 5 21 -1e+37 1e+37 0 1 \$0_batch_size empty batch\ size 0 -12 0 16 #fcfcfc #000000 #000000 4 256;
#N canvas 529 302 729 769 initialize_params 0;
#X obj 209 106 nn.initialize_params wL 1;
#X obj 209 136 nn.initialize_params bL 1;
#X obj 209 249 nn.initialize_params wL-1_1 1;
#X obj 209 279 nn.initialize_params bL-1_1 1;
#X obj 209 439 nn.initialize_params wL-2_1 1;
#X obj 209 469 nn.initialize_params bL-2_1 1;
#X obj 209 509 nn.initialize_params wL-2_2 1;
#X obj 209 539 nn.initialize_params bL-2_2 1;
#X obj 38 34 inlet bang;
#X obj 546 17 r \$0_ns;
#X obj 208 187 nn.initialize_params wL-1_0 1;
#X obj 209 216 nn.initialize_params bL-1_0 1;
#X obj 209 369 nn.initialize_params wL-2_0 1;
#X obj 209 399 nn.initialize_params bL-2_0 1;
#X connect 8 0 0 0;
#X connect 8 0 13 0;
#X connect 8 0 12 0;
#X connect 8 0 11 0;
#X connect 8 0 10 0;
#X connect 8 0 7 0;
#X connect 8 0 6 0;
#X connect 8 0 5 0;
#X connect 8 0 4 0;
#X connect 8 0 3 0;
#X connect 8 0 2 0;
#X connect 8 0 1 0;
#X connect 9 0 0 1;
#X connect 9 0 13 1;
#X connect 9 0 12 1;
#X connect 9 0 11 1;
#X connect 9 0 10 1;
#X connect 9 0 7 1;
#X connect 9 0 6 1;
#X connect 9 0 5 1;
#X connect 9 0 4 1;
#X connect 9 0 3 1;
#X connect 9 0 2 1;
#X connect 9 0 1 1;
#X restore 112 203 pd initialize_params;
#X msg 112 176 bang;
#X obj 588 56 r \$0_m_b;
#X msg 650 112 bang;
#X obj 650 84 r \$0_init;
#X obj 588 143 nn.array_cycle X;
#X obj 713 115 r \$0_ns;
#X obj 956 115 r \$0_ns;
#X obj 839 143 nn.array_read X;
#X obj 1156 115 r \$0_ns;
#X obj 1039 143 nn.array_read X;
#X obj 588 171 f;
#X obj 839 107 f;
#X obj 839 171 f;
#X obj 1039 52 f;
#X obj 438 444 nn.neuron_3 wL-2_0 bL-2_0 aL-2_0 zL-2_0 tanh;
#X obj 808 444 nn.neuron_3 wL-2_1 bL-2_1 aL-2_1 zL-2_1 tanh;
#X obj 1178 444 nn.neuron_3 wL-2_2 bL-2_2 aL-2_2 zL-2_2 tanh;
#X obj 1527 216 r \$0_ns;
#X obj 525 674 nn.neuron_3 wL-1_0 bL-1_0 aL-1_0 zL-1_0 tanh;
#X obj 1128 674 nn.neuron_3 wL-1_1 bL-1_1 aL-1_1 zL-1_1 tanh;
#X obj 869 844 nn.neuron_1 wL bL y_hat zL;
#X obj 713 176 t f f f;
#X obj 956 176 t f f f;
#X obj 1156 177 t f f f;
#X obj 1039 176 f;
#X obj 438 472 f;
#X obj 808 407 f;
#X obj 808 472 f;
#X obj 1178 410 f;
#X obj 1178 472 f;
#X obj 1477 536 r \$0_ns;
#X obj 612 478 t f f;
#X obj 982 478 t f f;
#X obj 1352 478 t f f;
#X obj 525 752 f;
#X obj 1128 636 f;
#X obj 1074 816 r \$0_ns;
#X obj 906 908 r \$0_batch_size;
#X obj 906 936 - 1;
#X obj 869 964 sel 3;
#X obj 869 993 f;
#X obj 869 1021 t f f;
#X obj 926 1022 + 1;
#X msg 929 990 0;
#X obj 929 963 r \$0_init;
#X obj 869 1065 s \$0_batch_count;
#X obj 1679 32 r \$0_batch_count;
#X obj 1679 60 t f b, f 22;
#X obj 1679 128 spigot;
#X obj 1724 100 tgl 23 0 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 0 1;
#X obj 1679 156 print batch_number;
#X obj 1903 111 nn.dz_mse y_hat Y daL;
#X obj 1903 258 nn.bp_2x3 dzL-1_0 dzL-1_1 daL-1_0 daL-1_1 zL-1_0 zL-1_1 aL-1_0 aL-1_1 dwL-1_0 dwL-1_1 aL-2_0 aL-2_1 aL-2_2 dbL-1_0 dbL-1_1 daL-2_0 daL-2_1 daL-2_2 wL-1_0 wL-1_1 tanh;
#X obj 1903 356 nn.bp_3x3 dzL-2_0 dzL-2_1 dzL-2_2 daL-2_0 daL-2_1 daL-2_2 zL-2_0 zL-2_1 zL-2_2 aL-2_0 aL-2_1 aL-2_2 dwL-2_0 dwL-2_1 dwL-2_2 X X X dbL-2_0 dbL-2_1 dbL-2_2 dX_0 dX_1 dX_2 wL-2_0 wL-2_1 wL-2_2 tanh;
#X obj 1903 598 nn.update wL-2_0 dwL-2_0;
#X obj 1903 628 nn.update wL-2_1 dwL-2_1;
#X obj 1903 686 nn.update bL-2_0 dbL-2_0;
#X obj 1903 714 nn.update bL-2_1 dbL-2_1;
#X obj 1903 742 nn.update bL-2_2 dbL-2_2;
#X obj 1903 658 nn.update wL-2_2 dwL-2_2;
#X obj 1903 780 nn.update wL-1_0 dwL-1_0;
#X obj 1903 808 nn.update wL-1_1 dwL-1_1;
#X obj 1903 864 nn.update bL-1_1 dbL-1_1;
#X obj 1903 836 nn.update bL-1_0 dbL-1_0;
#X obj 1903 902 nn.update wL dwL;
#X obj 1903 930 nn.update bL dbL;
#X obj 2471 32 r \$0_ns;
#X obj 2471 562 r \$0_ns;
#X obj 2471 372 r \$0_alpha;
#X obj 311 106 nbx 5 21 0 1 0 1 empty \$0_init learning\ rate 0 -12 0 16 #fcfcfc #000000 #000000 0.1 256;
#X obj 311 132 s \$0_alpha;
#X obj 1903 171 nn.bp_1x2 dzL daL zL y_hat dwL aL-1_0 aL-1_1 dbL daL-1_0 daL-1_1 wL linear;
#X connect 1 0 2 0;
#X connect 3 0 1 0;
#X connect 9 0 8 0;
#X connect 11 0 10 0;
#X connect 12 0 10 1;
#X connect 13 0 10 2;
#X connect 15 0 14 0;
#X connect 16 0 19 0;
#X connect 17 0 19 1;
#X connect 18 0 17 0;
#X connect 19 0 25 0;
#X connect 19 1 36 0;
#X connect 20 0 19 2;
#X connect 21 0 22 1;
#X connect 22 0 27 0;
#X connect 22 1 37 0;
#X connect 23 0 24 1;
#X connect 24 0 39 0;
#X connect 24 1 38 0;
#X connect 25 0 26 0;
#X connect 26 0 22 0;
#X connect 27 0 28 0;
#X connect 28 0 24 0;
#X connect 29 0 40 0;
#X connect 29 1 46 0;
#X connect 30 0 42 0;
#X connect 30 1 47 0;
#X connect 31 0 44 0;
#X connect 31 1 48 0;
#X connect 32 0 31 4;
#X connect 32 0 30 4;
#X connect 32 0 29 4;
#X connect 33 0 49 0;
#X connect 33 1 35 1;
#X connect 34 0 35 0;
#X connect 35 0 54 0;
#X connect 36 0 29 1;
#X connect 36 1 30 1;
#X connect 36 2 31 1;
#X connect 37 0 29 2;
#X connect 37 1 30 2;
#X connect 37 2 31 2;
#X connect 38 0 29 3;
#X connect 38 1 30 3;
#X connect 38 2 31 3;
#X connect 39 0 29 0;
#X connect 40 0 41 0;
#X connect 41 0 30 0;
#X connect 42 0 43 0;
#X connect 43 0 31 0;
#X connect 44 0 33 0;
#X connect 45 0 34 4;
#X connect 45 0 33 4;
#X connect 46 0 33 1;
#X connect 46 1 34 1;
#X connect 47 0 33 2;
#X connect 47 1 34 2;
#X connect 48 0 33 3;
#X connect 48 1 34 3;
#X connect 49 0 50 0;
#X connect 50 0 34 0;
#X connect 51 0 35 2;
#X connect 52 0 53 0;
#X connect 53 0 54 1;
#X connect 54 0 55 0;
#X connect 55 0 56 0;
#X connect 56 0 60 0;
#X connect 56 1 57 0;
#X connect 57 0 55 1;
#X connect 58 0 55 1;
#X connect 59 0 58 0;
#X connect 61 0 62 0;
#X connect 62 0 63 0;
#X connect 62 1 66 0;
#X connect 63 0 65 0;
#X connect 64 0 63 1;
#X connect 66 0 86 0;
#X connect 67 0 68 0;
#X connect 68 0 69 0;
#X connect 69 0 70 0;
#X connect 70 0 74 0;
#X connect 71 0 72 0;
#X connect 72 0 73 0;
#X connect 73 0 75 0;
#X connect 74 0 71 0;
#X connect 75 0 76 0;
#X connect 76 0 78 0;
#X connect 77 0 79 0;
#X connect 78 0 77 0;
#X connect 79 0 80 0;
#X connect 81 0 66 1;
#X connect 81 0 68 1;
#X connect 81 0 67 1;
#X connect 81 0 86 1;
#X connect 82 0 69 2;
#X connect 82 0 80 2;
#X connect 82 0 79 2;
#X connect 82 0 78 2;
#X connect 82 0 77 2;
#X connect 82 0 76 2;
#X connect 82 0 75 2;
#X connect 82 0 74 2;
#X connect 82 0 73 2;
#X connect 82 0 72 2;
#X connect 82 0 71 2;
#X connect 82 0 70 2;
#X connect 83 0 69 1;
#X connect 83 0 80 1;
#X connect 83 0 79 1;
#X connect 83 0 78 1;
#X connect 83 0 77 1;
#X connect 83 0 76 1;
#X connect 83 0 75 1;
#X connect 83 0 74 1;
#X connect 83 0 73 1;
#X connect 83 0 72 1;
#X connect 83 0 71 1;
#X connect 83 0 70 1;
#X connect 84 0 85 0;
#X connect 86 0 67 0;
